# 02 注解与反射：读取与处理

## 常见反射入口
- **类注解**：`clazz.getAnnotations() / getDeclaredAnnotations()`
- **字段注解**：`field.getAnnotations()`；类型使用注解：`field.getAnnotatedType()`
- **方法注解**：`method.getAnnotations()`；参数注解：`method.getParameterAnnotations()`
- **参数类型注解**：`method.getAnnotatedParameterTypes()`（与 `TYPE_USE` 相关）

对应示例：`com.fragment.core.annotations.AnnotationInspector`

```java
public static void inspectAll(Class<?> clazz) {
    printAnnotations("Class", clazz.getAnnotations());
    inspectFields(clazz);   // 字段/类型注解
    inspectMethods(clazz);  // 方法/参数注解
}
```

## 读取 TYPE_USE 注解
- 使用 `AnnotatedType`/`AnnotatedParameterizedType`：
  - 字段为 `List<@TypeUseAnno String> tags;`
  - 通过 `field.getAnnotatedType()` 获取 `AnnotatedType`，再下钻至类型实参。

示例代码片段（已在 `AnnotationInspector` 内实现）：
```java
AnnotatedType at = f.getAnnotatedType();
if (at instanceof AnnotatedParameterizedType) {
    AnnotatedType[] args = ((AnnotatedParameterizedType) at).getAnnotatedActualTypeArguments();
    // 遍历 args[i].getAnnotations()
}
```

## 注意事项
- 只有 `RUNTIME` 保留策略的注解才能通过反射读取。
- `Parameter#getName()` 需要编译参数 `-parameters` 才能拿到真实参数名，否则是 `arg0/arg1`。
- `@Inherited` 仅对 `TYPE` 生效，方法/字段不继承。

## 快速试用
- 运行 `AnnotationDemoMain.main()`：
  - 打印 `AnnotatedUser` 的类/字段/参数/TYPE_USE 注解信息。
  - 演示动态代理下 `@LogExecutionTime` 的读取与耗时输出。
